--
-- maintained on scooter at  /home/collspec/projects/staff-portal/sprint-server/src/db/queries/collection/suggestions/continuations_isn_match.sql
--

-- use 
-- ="('" & C2 & "'), " 
-- on spreadsheet to get values


drop  table  if exists  possible_matches;
create temp table possible_matches (identifier varchar);
insert into possible_matches values 
('9781432881146'), 
('9781432883164'), 
('9781432881412'), 
('9781432879709'), 
('9781432880514'), 
('9781432878474'), 
('9781432878672'), 
('9781432881382'), 
('9781432881931'), 
('9781432878573'), 
('9781432877569'), 
('9781432878450'), 
('9781432881184'), 
('9781432880507'), 
('9781432880842'), 
('9781432882686'), 
('9781432881177'), 
('9781432881399'), 
('9781432881344'), 
('9781432879792'), 
('9781432879662'), 
('9781432879235'), 
('9781432878801'), 
('9781432880569'), 
('9781432872526'), 
('9781432881948'), 
('9781432878498'), 
('9781432878467'), 
('9781432880552'), 
('9781432880811'), 
('9781432877545'), 
('9781432880576'), 
('9781432878436'), 
('9781432877101'), 
('9781432881405'), 
('9781432879594'), 
('9781432878702'), 
('9781432879655'), 
('9781432880477'), 
('9781432879624'), 
('9781432878665'), 
('9781432878429'), 
('9781432879587'), 
('9781432879273'), 
('9781432878566'), 
('9781432880330'), 
('9781432872540'), 
('9781432876623'), 
('9781432881368'), 
('9781432876555'), 
('9781432872533'), 
('9781432878696'), 
('9781432880484'), 
('9781432879648'), 
('9781432879228'), 
('9781432878689'), 
('9781432877552'), 
('9781432879808'), 
('9781432877576'), 
('9781432877552'), 
('9781432879808'), 
('9781432877576'), 
('9780593212479'), 
('9781432878726'), 
('9781432878733'), 
('9781432879167'), 

('9780593286104'), 
('9781432881665'), 
('9781432879174'), 
('9781432879556'), 
('9780593294994'), 
('9780062843098'), 
('9780062835147'), 
('9780593213513'), 
('9780593171554'), 
('9780316497961'), 
('9780593171806'), 
('9780593285985'), 
('9781538752173'), 
('9780063028906'), 
('9780593214749'), 
('9781432879181'), 
('9780316539593'), 
('9780316418317'), 
('9780316494946'), 
('9781432878511'), 
('9781432878504'), 
('9780062999863'), 
('9781432880521'), 
('9781432878559'), 
('9781432880460'), 
('9781432882327'), 
('9781538748121'), 
('9781432880491'), 
('9781432878528'), 
('9780062999917'), 
('9780062999894'), 
 
('9781538752159'), 
('9781538754245');

with uniques as (
select distinct(identifier) from possible_matches),

-- select * from possible_matches;


 
record_num_identifier_phrase_entry as (
SELECT
u.*, 
id2reckey(e.record_id) as content
FROM
uniques U
left join
sierra_view.phrase_entry  e

on
e.index_tag || e.index_entry = 'i' || u.identifier


)
select identifier::bigint from record_num_identifier_phrase_entry pe where content is null;