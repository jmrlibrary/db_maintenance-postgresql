
drop table if exists  a;
create temp table a (isn varchar);

with b as (

insert into a values

('%9780310423157%'), 
('%9780310865759%'), 
('%9780745957821%'), 
('%9780745957999%'), 
('%9780795337925%'), 
('%9780990460831%'), 
('%9780990541509%'), 
('%9780990783343%'), 
('%9780990783381%'), 
('%9780996574440%'), 
('%9780997270105%'), 
('%9780997270112%'), 
('%9780997270174%'), 
('%9781071513323%'), 
('%9781402278556%'), 
('%9781402278587%'), 
('%9781423648956%'), 
('%9781426895661%'), 
('%9781459225732%'), 
('%9781459227057%'), 
('%9781459241251%'), 
('%9781459256606%'), 
('%9781460312049%'), 
('%9781460385715%'), 
('%9781510700321%'), 
('%9781510700338%'), 
('%9781510700345%'), 
('%9781510700468%'), 
('%9781510700611%'), 
('%9781510701939%'), 
('%9781510701946%'), 
('%9781510702059%'), 
('%9781510702066%'), 
('%9781510702097%'), 
('%9781510702127%'), 
('%9781510702547%'), 
('%9781510703414%'), 
('%9781510703681%'), 
('%9781510703773%'), 
('%9781510705159%'), 
('%9781510705173%'), 
('%9781510706989%'), 
('%9781510707153%'), 
('%9781510707269%'), 
('%9781510708440%'), 
('%9781510709119%'), 
('%9781510709133%'), 
('%9781510709157%'), 
('%9781510709522%'), 
('%9781510709713%'), 
('%9781510709768%'), 
('%9781510710061%'), 
('%9781510710108%'), 
('%9781510710153%'), 
('%9781510711006%'), 
('%9781510711150%'), 
('%9781510711273%'), 
('%9781510711563%'), 
('%9781510711648%'), 
('%9781510711662%'), 
('%9781510711891%'), 
('%9781510712430%'), 
('%9781510712607%'), 
('%9781510712744%'), 
('%9781510712973%'), 
('%9781510713246%'), 
('%9781510713444%'), 
('%9781510713574%'), 
('%9781510713635%'), 
('%9781510713659%'), 
('%9781510714960%'), 
('%9781510715844%'), 
('%9781510715875%'), 
('%9781510716179%'), 
('%9781510716261%'), 
('%9781510717084%'), 
('%9781510717152%'), 
('%9781510717190%'), 
('%9781510717299%'), 
('%9781510717671%'), 
('%9781510717732%'), 
('%9781510717787%'), 
('%9781510717817%'), 
('%9781510717824%'), 
('%9781510717916%'), 
('%9781510718357%'), 
('%9781510718739%'), 
('%9781510719279%'), 
('%9781510719583%'), 
('%9781510719637%'), 
('%9781510719712%'), 
('%9781510719750%'), 
('%9781510719774%'), 
('%9781510719910%'), 
('%9781510721432%'), 
('%9781510721760%'), 
('%9781510721807%'), 
('%9781510721838%'), 
('%9781510722156%'), 
('%9781510722279%'), 
('%9781510724419%'), 
('%9781510724655%'), 
('%9781510724730%'), 
('%9781510725959%'), 
('%9781510726222%'), 
('%9781510726796%'), 
('%9781510727816%'), 
('%9781510728011%'), 
('%9781510729124%'), 
('%9781510729285%'), 
('%9781510732667%'), 
('%9781510736610%'), 
('%9781510739338%'), 
('%9781510740358%'), 
('%9781510758728%'), 
('%9781597805599%'), 
('%9781597808484%'), 
('%9781597808507%'), 
('%9781597808613%'), 
('%9781604696790%'), 
('%9781611457742%'), 
('%9781611458275%'), 
('%9781611458282%'), 
('%9781611458442%'), 
('%9781613630150%'), 
('%9781620873014%'), 
('%9781620873885%'), 
('%9781620874981%'), 
('%9781620879580%'), 
('%9781626362475%'), 
('%9781626362529%'), 
('%9781626363809%'), 
('%9781626365100%'), 
('%9781626365155%'), 
('%9781626365971%'), 
('%9781626366312%'), 
('%9781626366558%'), 
('%9781626366749%'), 
('%9781626369153%'), 
('%9781626815803%'), 
('%9781626815810%'), 
('%9781626817241%'), 
('%9781626817265%'), 
('%9781628721102%'), 
('%9781628721164%'), 
('%9781628721614%'), 
('%9781628721621%'), 
('%9781628721850%'), 
('%9781628721911%'), 
('%9781628722062%'), 
('%9781628722802%'), 
('%9781628723601%'), 
('%9781628723632%'), 
('%9781628723946%'), 
('%9781628724059%'), 
('%9781628724684%'), 
('%9781628724769%'), 
('%9781628724875%'), 
('%9781628725537%'), 
('%9781628725964%'), 
('%9781628726138%'), 
('%9781628726152%'), 
('%9781628726237%'), 
('%9781628726350%'), 
('%9781628726589%'), 
('%9781628726671%'), 
('%9781628726701%'), 
('%9781628726831%'), 
('%9781628726848%'), 
('%9781628726879%'), 
('%9781628726893%'), 
('%9781628727067%'), 
('%9781628727142%'), 
('%9781628727159%'), 
('%9781628727340%'), 
('%9781628727685%'), 
('%9781628728095%'), 
('%9781628728477%'), 
('%9781628728538%'), 
('%9781628730906%'), 
('%9781628730913%'), 
('%9781628730920%'), 
('%9781628731873%'), 
('%9781628732450%'), 
('%9781628732610%'), 
('%9781628733273%'), 
('%9781628734225%'), 
('%9781628734553%'), 
('%9781628734706%'), 
('%9781628735215%'), 
('%9781628735246%'), 
('%9781628738056%'), 
('%9781628738063%'), 
('%9781628738667%'), 
('%9781628739374%'), 
('%9781628739497%'), 
('%9781629140766%'), 
('%9781629141213%'), 
('%9781629141336%'), 
('%9781629142784%'), 
('%9781629143231%'), 
('%9781629148472%'), 
('%9781629148489%'), 
('%9781629148809%'), 
('%9781629148984%'), 
('%9781629149295%'), 
('%9781629149493%'), 
('%9781629149646%'), 
('%9781629149936%'), 
('%9781631440670%'), 
('%9781631580352%'), 
('%9781631580512%'), 
('%9781631580543%'), 
('%9781631580567%'), 
('%9781631580710%'), 
('%9781631580925%'), 
('%9781631581090%'), 
('%9781631581823%'), 
('%9781631582226%'), 
('%9781631582240%'), 
('%9781631583537%'), 
('%9781632200310%'), 
('%9781632200440%'), 
('%9781632200761%'), 
('%9781632201010%'), 
('%9781632201089%'), 
('%9781632201591%'), 
('%9781632201614%'), 
('%9781632201898%'), 
('%9781632204202%'), 
('%9781632207791%'), 
('%9781632207807%'), 
('%9781632207869%'), 
('%9781632207913%'), 
('%9781632208132%'), 
('%9781632209016%'), 
('%9781632209467%'), 
('%9781632209948%'), 
('%9781632659330%'), 
('%9781634500111%'), 
('%9781634500166%'), 
('%9781634501156%'), 
('%9781634508308%'), 
('%9781634508353%'), 
('%9781634508810%'), 
('%9781634509015%'), 
('%9781634509251%'), 
('%9781634509350%'), 
('%9781634509732%'), 
('%9781635764253%'), 
('%9781682300756%'), 
('%9781682300831%'), 
('%9781682303122%'), 
('%9781682303245%'), 
('%9781940456188%'), 
('%9781940456300%'), 
('%9781940456614%'), 
('%9781940456850%'), 
('%9781943772919%'), 
('%9781944824075%'), 
('%9781944824259%'), 
('%9781944962005%'), 
('%9781944962302%'), 
('%9781944962470%'), 
('%9781944962494%'), 
('%9781945863363%'), 
('%9782291087465%')

returning *

), c as (

select id2reckey(record_id) from sierra_view.subfield s, b

where 

s.marc_tag in ('020', '024', '028')
and s.tag = 'a'


and s.content like b.isn)

select string_agg('"' || id2reckey || '"', ',') from c;

